<?phpif(!defined('IN_STORE')) die(); //Si ca doit être un fichier inclutif($account->getConnected()){	$smarty->assign('missing_field', false);	$smarty->assign('invalid_format', false);	$smarty->assign('expired_card', false);	$smarty->assign('is_validate', false);	if($_POST)	{				if(isset($_POST['numeroCarte']) && !empty($_POST['numeroCarte']) 			&& isset($_POST['trigramme']) && !empty($_POST['trigramme'])			&& isset($_POST['dateExp']) && !empty($_POST['dateExp'])			&& isset($_POST['adLiv']) && !empty($_POST['adLiv'])			&& isset($_POST['pays'])  && !empty($_POST['pays'])			&& isset($_POST['cp']) && !empty($_POST['cp'])			&& isset($_POST['ville']) && !empty($_POST['ville']))		{			if(!preg_match('/^[0-9]{16}$/', $_POST['numeroCarte'])                || !preg_match('/^[0-9]{3}$/', $_POST['trigramme'])				|| !preg_match('#^[0-9]{1,2}/[0-9]{1,2}$#', $_POST['dateExp'])				|| !preg_match('/^[0-9a-zA-Z\s]{10,}$/', $_POST['adLiv'])				|| !preg_match('/^[a-zA-Z\s]{3,}$/', $_POST['pays'])				|| !preg_match('/^[0-9]{1,6}$/', $_POST['cp'])                || !preg_match('/^[a-zA-Z\s]{3,}$/', $_POST['ville'])              )            {                $smarty->assign('invalid_format', true);            }			else			{			// si année est sup ou égale à l'année en cours, 			//si l'année est égale en cours on vérifie que le mois est sup si oui OK, 			//sinon si l'année est sup OK				$tab = explode('/', $_POST['dateExp']); // tab[0]=mois, tab[1]=année				$cardExp = false;				if($tab[1] >= date('y') && $tab[0]<=12)				{					if($tab[1] == date('y'))					{						if($tab[0] < date('m'))						{							$cardExp = true;							$smarty->assign('expired_card', true);						}							}				}				else				{					$cardExp = true;					$smarty->assign('expired_card', true);				}				if(!$cardExp)				{					if($cart->validate($account->getID(), $_POST['adLiv'], $_POST['cp'], $_POST['ville'], $_POST['pays'] ))					{						$smarty->assign('is_validate', true);					}				}			}		}		else		{			$smarty->assign('missing_field', true);		}	}}$smarty->assign('account', $account);?>